<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>NITC 2021-2024 ❤️</title>

    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <style>
      .mail-icon {
        position: fixed;
        top: 10px;
        right: 10px;
        background-color: #ffffff9e;
        border-radius: 50%;
        padding: 10px;
        box-shadow: 0 0 5px #f5986e;
        cursor: pointer;
        transition: background-color 0.3s ease;
        z-index: 1001;
      }
      .mail-icon:hover {
        background-color: #f5986e;
      }
      .fa-envelope {
        color: #f25346;
      }

      .mail-popup {
        display: none;
        position: fixed;
        top: 10px;
        left: 20px;
        width: 85%;
        background: #86595330;
        border-radius: 10px;
        box-shadow: 0 0 10px #f5986e;
        padding: 20px;
        z-index: 1000;
        overflow: auto;
        opacity: 0;
        transition: opacity 0.5s ease;
        max-height: 80vh;
      }
      .mail-popup.active {
        display: block;
        opacity: 1;
      }
      .mail-popup h2 {
        margin-top: 0;
      }
      .mail-popup .close-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 20px;
        cursor: pointer;
      }
      .mail-popup .content span {
        display: inline-block;
        opacity: 0;
        transition: opacity 0.5s ease;
      }

      /* Upload Interface Styles */
      .toggle-upload-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: linear-gradient(135deg, #f5986e, #f25346);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1001;
        transition: transform 0.3s ease, background 0.3s ease;
      }

      .toggle-upload-btn:hover {
        transform: scale(1.1);
        background: linear-gradient(135deg, #f25346, #f5986e);
      }

      .upload-interface {
        position: fixed;
        bottom: -100%;
        left: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        border-radius: 20px 20px 0 0;
        padding: 20px;
        z-index: 1000;
        transition: bottom 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        backdrop-filter: blur(10px);
        max-height: 80vh;
        overflow-y: auto;
        box-sizing: border-box;
      }

      .upload-interface.active {
        bottom: 0;
      }

      .upload-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        padding-bottom: 10px;
      }

      .upload-header h2 {
        color: #23190f;
        margin: 0;
        font-size: 1.5rem;
      }

      .upload-header .close-btn {
        background: none;
        border: none;
        color: #f25346;
        font-size: 1.5rem;
        cursor: pointer;
      }

      .upload-btn {
        display: block;
        width: 100%;
        padding: 15px;
        background: linear-gradient(to right, #f5986e, #f25346);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .upload-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
      }

      .upload-btn i {
        margin-right: 8px;
      }

      .image-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
        margin-top: 20px;
      }

      .gallery-img-container {
        position: relative;
        aspect-ratio: 1/1;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .gallery-img-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
      }

      .gallery-img-container:hover img {
        transform: scale(1.05);
      }

      .delete-img-btn {
        position: absolute;
        top: 5px;
        right: 5px;
        background: rgba(242, 83, 70, 0.8);
        color: white;
        border: none;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;
        z-index: 1001;
        transition: opacity 0.2s ease;
      }

      .gallery-img-container:hover .delete-img-btn {
        opacity: 1;
        z-index: 1000;
      }

      .notification {
        position: fixed;
        top: -60px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(69, 130, 72, 0.9);
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 0.9rem;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        z-index: 1002;
        transition: top 0.3s ease;
      }

      .notification.show {
        top: 20px;
      }

      /* URL Input Form Styles */
      .url-form-container {
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .url-input-container {
        display: flex;
        gap: 10px;
      }

      .url-input {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ddd;
        font-size: 1rem;
      }

      .download-btn {
        background-color: #68c3c0;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.2s ease;
      }

      .download-btn:hover {
        background-color: #5ab8b5;
      }

      .section-title {
        margin-top: 20px;
        margin-bottom: 5px;
        font-weight: bold;
        color: #23190f;
      }

      /* Media queries for iPhone 12 and similar devices */
      @media only screen and (max-width: 428px) {
        .mail-popup {
          width: 85%;
          left: 7.5%;
          padding: 15px;
          font-size: 14px;
          max-height: 70vh;
        }

        .mail-icon {
          top: 15px;
          right: 15px;
        }

        .toggle-upload-btn {
          width: 50px;
          height: 50px;
          font-size: 20px;
          bottom: 15px;
          right: 15px;
        }

        .upload-interface {
          padding: 15px;
        }

        .upload-header h2 {
          font-size: 1.2rem;
        }

        .image-gallery {
          grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
          gap: 8px;
        }

        .upload-btn {
          padding: 12px;
          font-size: 0.9rem;
        }

        .notification {
          width: 80%;
          font-size: 0.8rem;
          padding: 8px 15px;
        }
      }

      /* Music Player Styles */
      .music-player {
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 300px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        padding: 15px;
        z-index: 1000;
        backdrop-filter: blur(10px);
        transform: translateX(120%);
        transition: transform 0.3s ease;
      }

      .music-player.active {
        transform: translateX(0);
      }

      .music-toggle-btn {
        position: fixed;
        bottom: 90px;
        right: 20px;
        background: linear-gradient(135deg, #68c3c0, #458248);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 20px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        z-index: 1001;
        transition: transform 0.3s ease;
      }

      .music-toggle-btn:hover {
        transform: scale(1.1);
      }

      .track-info {
        text-align: center;
        margin-bottom: 15px;
      }

      .track-title {
        font-weight: bold;
        color: #23190f;
        margin: 5px 0;
      }

      .track-artist {
        color: #666;
        font-size: 0.9em;
      }

      .controls {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        margin: 15px 0;
      }

      .control-btn {
        background: none;
        border: none;
        color: #23190f;
        cursor: pointer;
        font-size: 24px;
        transition: transform 0.2s ease;
      }

      .control-btn:hover {
        transform: scale(1.1);
      }

      .progress-container {
        width: 100%;
        height: 4px;
        background: #ddd;
        border-radius: 2px;
        margin: 10px 0;
        cursor: pointer;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(to right, #68c3c0, #458248);
        border-radius: 2px;
        width: 0%;
        transition: width 0.1s linear;
      }

      .playlist {
        margin-top: 15px;
        max-height: 150px;
        overflow-y: auto;
      }

      .playlist-item {
        display: flex;
        align-items: center;
        padding: 8px;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }

      .playlist-item:hover {
        background: rgba(104, 195, 192, 0.1);
      }

      .playlist-item.active {
        background: rgba(104, 195, 192, 0.2);
      }

      .add-track-btn {
        width: 100%;
        padding: 10px;
        background: linear-gradient(to right, #68c3c0, #458248);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 10px;
        transition: transform 0.2s ease;
      }

      .add-track-btn:hover {
        transform: translateY(-2px);
      }
    </style>
  </head>
  <body>
    <div id="world">
      <div id="mail-icon" class="mail-icon">
        <i class="fas fa-envelope"></i>
      </div>
      <div id="mail-popup" class="mail-popup">
        <div class="close-btn"></div>
        <div class="content" id="text-content"></div>
      </div>

      <!-- Upload interface -->
      <button id="toggle-upload-btn" class="toggle-upload-btn">
        <i class="fas fa-images"></i>
      </button>

      <div id="upload-interface" class="upload-interface">
        <div class="upload-header">
          <h2>Thêm ảnh</h2>
          <button class="close-btn" onclick="toggleUploadInterface()">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <button id="upload-btn" class="upload-btn">
          <i class="fas fa-cloud-upload-alt"></i> Tải ảnh từ thiết bị
        </button>

        <!-- URL Input Form -->
        <div class="url-form-container">
          <div class="section-title">Hoặc nhập đường dẫn ảnh từ internet:</div>
          <div class="url-input-container">
            <input
              type="text"
              id="image-url-input"
              class="url-input"
              placeholder="Nhập đường dẫn ảnh..." />
            <button id="download-btn" class="download-btn">Tải ảnh</button>
          </div>
        </div>

        <div id="image-gallery" class="image-gallery">
          <!-- Gallery images will be added here dynamically -->
        </div>
      </div>

      <!-- Notification -->
      <div id="notification" class="notification"></div>
    </div>

    <!-- Music Player -->
    <button id="music-toggle-btn" class="music-toggle-btn">
      <i class="fas fa-music"></i>
    </button>

    <div id="music-player" class="music-player">
      <div class="track-info">
        <div class="track-title">No track selected</div>
        <div class="track-artist">-</div>
      </div>

      <div class="progress-container" id="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>

      <div class="controls">
        <button class="control-btn" id="prev-btn">
          <i class="fas fa-step-backward"></i>
        </button>
        <button class="control-btn" id="play-btn">
          <i class="fas fa-play"></i>
        </button>
        <button class="control-btn" id="next-btn">
          <i class="fas fa-step-forward"></i>
        </button>
      </div>

      <div class="playlist" id="playlist">
        <!-- Playlist items will be added here dynamically -->
      </div>

      <button class="add-track-btn" id="add-track-btn">
        <i class="fas fa-plus"></i> Add Track
      </button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/86/three.min.js"></script>
    <!-- Add Cloudinary Upload Widget -->
    <script
      src="https://upload-widget.cloudinary.com/global/all.js"
      type="text/javascript"></script>
    <!-- Add debugging tools -->
    <script src="js/debug.js"></script>
    <!-- Add our API client before the main script -->
    <script src="js/api.js"></script>
    <script src="js/index.js"></script>
    <script>
      function splitTextIntoSpans() {
        const textContent =
          "Mấy nay suy nghĩ về NITC, về kết thúc của một hành trình, về các chặng đường đã đi qua.. Nếu không may mắn vào được ban HT, có lẽ sẽ không học hỏi được nhiều như vậy. Nếu không là thành viên của NITC, có lẽ những năm tháng sinh viên ngắn ngủi này sẽ tẻ nhạt hơn rất nhiều.. Một người khá là không tự tin về bản thân nên đã tự xây nên một hình tượng rụt rè ít nói, cảm thấy khó để kết bạn với người khác, dễ ovtk và cũng dễ.. trở nên im lặng. Khi mới vào clb mục đích đơn giản chỉ là học tập các kiến thức chuyên ngành để phục cho bản thân cho đến khi thấy những người khác chạy dl cùng nhau, làm việc cùng nhau, tổ chức sự kiện cùng nhau, chơi cùng nhau, lúc đó mới thấy mình đã lãng phí những trải nghiệm tuyệt vời như nào.. Năm vừa rồi không đóng góp gì cho clb nhiều nhưng cũng được tham gia mấy chuyến đi chơi, dù gần hay xa thì đó cũng là những chuyến đi thật tuyệt. Sau mỗi chuyến đi vẫn luôn muốn lưu trữ lại theo một cách “đặc biệt” nào đó (mượn code để tạo ra web như này :3), không biết đã là lần cuối chưa, không biết những người bạn sẽ ra sao.. đôi khi không biết kết quả sẽ ra sao nhưng dù sao cũng được trải qua quá trình tuyệt vời. “We write to taste life twice, in the moment and in retrospect” ";
        const contentDiv = document.getElementById("text-content");
        const newHtml = textContent
          .split("\n")
          .map(
            (line) =>
              line
                .split("")
                .map((char) => `<span>${char === " " ? "&nbsp;" : char}</span>`)
                .join("") + "<br>"
          )
          .join("");

        contentDiv.innerHTML = newHtml;
      }

      function handleMailPopup() {
        const popup = document.getElementById("mail-popup");
        popup.classList.toggle("active");

        const spans = document.querySelectorAll(".mail-popup .content span");
        if (popup.classList.contains("active")) {
          spans.forEach((span, index) => {
            setTimeout(() => {
              span.style.opacity = 1;
            }, index * 100);
          });
        } else {
          spans.forEach((span) => {
            span.style.opacity = 0;
          });
        }
      }

      // Make handleMailPopup available globally
      window.handleMailPopup = handleMailPopup;

      document
        .getElementById("mail-icon")
        .addEventListener("click", handleMailPopup);

      splitTextIntoSpans();

      // Add touch event listeners for mobile
      document.addEventListener("DOMContentLoaded", function () {
        // Touch event for mail icon
        const mailIcon = document.getElementById("mail-icon");
        mailIcon.addEventListener("touchstart", function (e) {
          e.preventDefault();
          handleMailPopup();
        });

        // Close popup with touch outside
        document.addEventListener("touchstart", function (e) {
          const popup = document.getElementById("mail-popup");
          if (
            popup.classList.contains("active") &&
            !popup.contains(e.target) &&
            !mailIcon.contains(e.target)
          ) {
            handleMailPopup();
          }
        });

        // Define toggleUploadInterface in case it's not loaded yet
        if (typeof toggleUploadInterface !== "function") {
          window.toggleUploadInterface = function () {
            const uploadInterface = document.getElementById("upload-interface");
            if (uploadInterface) {
              uploadInterface.classList.toggle("active");
            }
          };
        }
      });
    </script>
  </body>
</html>
